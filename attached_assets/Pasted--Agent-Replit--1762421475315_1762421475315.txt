ุฌููู โ ูููุง ููู ุงูููุณุชูุฏ ุงูููุงุฆู ุงูููุฌูู ููุฑูู ุงูุชุทููุฑ / Agent ุนูู Replit ูุชูููุฐ ูุธุงู ุงูุตูุงุญูุงุช ูุงูุญุณุงุจุงุช ุงููุชูุงูู ูุงููุญุณูู ูุตุงูุญู ููุณุชุฎุฏู ุฑุฆูุณูุ ูุน ูู ุงูุชูุงุตูู ูุงูุฎูุงุฑุงุช ุงูุฐููุฉ ุงููุทููุจุฉ (ุฏูุฑุงู ุงููุณุชุฎุฏูููุ ุตูุงุญูุงุช ููุตูููุฉุ ุฃุฏูุงุช ุฅุฏุงุฑุฉุ ุณุฌูุงุชุ ูุงุฌูุฉ ุฅุฏุงุฑุฉุ ููุฒุงุช ูุณุงุนุฏุฉ ูุซู Impersonation ู View-As ู Export approvals ูุบูุฑูุง). ุงูุณุฎ ูุฐุง ุงููุต ูุงูููุง ูุงูุตูู ูู Issue ุฃู Prompt ุนูุฏ ุชุดุบูู ุงูู Agent ุนูู Replit ุฃู ุฅุฑุณุงูู ูููุทููุฑ.

โธป

๐ Specification: Roles & Permissions System โ A.Z Finance Hub

ุงูุบุฑุถ: ุชูููุฐ ูุธุงู ุตูุงุญูุงุช ูุชูุฏูู ูุถูู ูู (ุงูู Owner) ุณูุทุฑุฉ ุชุงูุฉ ุนูู ูู ูุฑู ููุนุฏูู ูุงุฐุง ุฏุงุฎู ุงูุชุทุจููุ ูุน ูุงุฌูุฉ ุฅุฏุงุฑุฉ ุณููุฉุ ุตูุงุญูุงุช ูุงุจูุฉ ููุชุฎุตูุต ุนูู ูุณุชูู ุงูุญูู/ุงูุตูุ ุฃุฏูุงุช ูุฑุงูุจุฉ (Audit) ูููุฒุงุช ูุณุงุนุฏุฉ ุนูููุฉ (Impersonation, View-As, Export Approval, Temporary Permissions).

โธป

1. ูุชุทูุจุงุช ุนุงููุฉ ุงููุณุชูู
	1.	ูุธุงู ุฃุฏูุงุฑ ูุงุจู ููุชูุณุนุฉ: Owner, Admin, Advanced Analyst, Basic Analyst, Data Entry, Viewer.
	2.	ูุงุฌูุฉ โุฅุฏุงุฑุฉ ุงููุณุชุฎุฏููู ูุงูุตูุงุญูุงุชโ ูุงุจูุฉ ููุงุณุชุฎุฏุงู ูู ูุจูู (Owner) ูุชุนููู/ุชุนุฏูู/ุฅููุงู/ุญุฐู ุงููุณุชุฎุฏููู ุจุณุฑุนุฉ.
	3.	ุตูุงุญูุงุช ูุงุจูุฉ ููุชุฎุตูุต ุนูู ูุณุชูู: ููุตุฉุ ูุณู (Dashboard/Investments/Reports/Settings)ุ ุญู ุงูุงุทูุงุน ุนูู ุงูุฃุฑูุงู ุงูููุฏูุฉ ุฃู ุงููุณุจ ููุทุ ุนูููุงุช CRUD (Create/Read/Update/Delete).
	4.	ุณุฌู ุชุฏููู (Audit Log) ูุณุฌู ูู ุญุฏุซ ุญุณุงุณ (ุนุฑุถ ุฑููุ ุชุนุฏููุ ุญุฐูุ Impersonationุ Export).
	5.	ุฃุฏูุงุช ุฎุงุตุฉ ุจุงููุงูู: Impersonate (ุชูููุต ูุคููุช)ุ View-As (ุนุฑุถ ูุงุฌูุฉ ููุง ูุฑุงูุง ุฃู ุฏูุฑ)ุ Quick Role Changeุ Export Approval Flow.
	6.	ุณูุงุณุงุช ุฃูููุฉ ุชุดุบูููุฉ: ุชุฃููุฏ ุจุงูู2FA ุนูุฏ ุนูููุงุช Export ุบูุฑ ุนุงุฏูุฉ ุฃู ุชูุนูู ุญุณุงุจ Advanced Analyst. (ุทุจุนุง ุทุจู ูุง ุชุฑุงู ููุงุณุจูุง ููู ูุง ุชูููุฏ ูุฏุฑุชู ููุงูู).

โธป

2. ุงูุฃุฏูุงุฑ ูุชุนุฑูููุง (Roles) โ ุงููุตู ูุงูุณููู

A. Owner (ูุงูู)
	โข	ุตูุงุญูุงุช ูุงููุฉ: ุนุฑุถ ูู ุงูุจูุงูุงุช (ุฃุฑูุงูุ ุชูุงุฑูุฎุ ุฅุนุฏุงุฏุงุช)ุ ุฅุถุงูุฉ/ุญุฐู ูุณุชุฎุฏูููุ ุชุนุฏูู ุงูุตูุงุญูุงุชุ ุชูุนูู/ุชุนุทูู ููุตุงุชุ Impersonateุ ุทูุจ ุฃู ุงูููุงููุฉ ุนูู Export ุบูุฑ ุงูููููุน.
	โข	ูุงุฌูุฉ Owner ุชุนุฑุถ ุฒุฑูุงุช ุณุฑูุนุฉ: Add User, Manage Roles, Audit Log, Impersonate, Export Requests.

B. Admin (ูุฏูุฑ)
	โข	ุตูุงุญูุงุช ูุงุณุนุฉ ูุฅุฏุงุฑุฉ ุงููุญุชูู: ุชุนุฏูู ูุญุฐู ุงููุฑุตุ ุฅุฏุงุฑุฉ ุงูููุตุงุชุ ูุดุงูุฏุฉ ุชูุงุฑูุฑ ููุตููุฉ.
	โข	ูุง ูุณุชุทูุน ุญุฐู Owner ุฃู ุชุบููุฑ ุฏูุฑู.

C. Advanced Analyst (ูุญูู ูุชูุฏู)
	โข	ูุฑู ูู ุงูุฃุฑูุงู ุงููุงููุฉ ูู ุงููุงุฌูุฉ (ูุจุงูุบ ุจุงูุฑูุงูุ ุชูุงุฑูุฎุ ROI).
	โข	ููููู ุชุดุบูู ุชุญูููุงุช ูุฅุตุฏุงุฑ ุชูุงุฑูุฑ.
	โข	ูุง ูููู ุญู ุญุฐู ุงููุณุชุฎุฏููู ุฃู ุชุบููุฑ ุฅุนุฏุงุฏุงุช ุงููุธุงู ุงูุฌููุฑูุฉ ุจุฏูู ููุงููุฉ Owner.

D. Basic Analyst (ูุญูู ุฃุณุงุณู)
	โข	ูุฑู ูุคุดุฑุงุช ููุณุจ (ROI%, Delayed%), ูุง ูุฑู ุงูุฃุฑูุงู ุงูููุฏูุฉ ุงููุทููุฉ.
	โข	ููููู ุชุดุบูู ุชูุงุฑูุฑ ูุจุณุทุฉ ููุดุงูุฏุฉ ุฑุณููุงุช ุจูุงููุฉ ููุณุจูุฉ ููุท.

E. Data Entry (ูุฏุฎู ุจูุงูุงุช)
	โข	ููููู ุฅุถุงูุฉ ูุชุญุฏูุซ ุงูุญููู ุบูุฑ ุงูุญุณุงุณุฉ: ุงุณู ุงููุฑุตุฉุ ุงูุชูุงุฑูุฎุ ุงูููุงุญุธุงุชุ ุญุงูุฉ ูุจุฏุฆูุฉ.
	โข	ูุง ูุฑู ุฃู ุฃุฑูุงู ููุฏูุฉ ุฃู ุจูุงูุงุช ุดุฎุตูุฉ ูููุณุชุฎุฏููู.
	โข	ูุง ููููู ุญุฐู ุจูุงูุงุช ุญุณุงุณุฉ ุฃู ุชุตุฏูุฑูุง.

F. Viewer (ูุดุงูุฏ ููุท)
	โข	ูุดุงูุฏุฉ ุนุงูุฉ ูููุญุฉ (ูุฎููุฉ)ุ ูุง ูููู ุฃู ุตูุงุญูุงุช ูุชุงุจุฉ ุฃู ุชุตุฏูุฑ.

โธป

3. ูุตูููุฉ ุงูุตูุงุญูุงุช (Permissions Matrix) โ ุฃูุซูุฉ ุนูููุฉ

(ููุทุจูุน ูู ุงูุชุทุจูู ูุฌุฏูู ูุงุจูู ููุชุนุฏูู ูุงุญููุง)

Permission / Role	Owner	Admin	AdvAnalyst	BasicAnalyst	DataEntry	Viewer
View all numbers	โ๏ธ	โ๏ธ	โ๏ธ	โ๏ธ	โ๏ธ	โ๏ธ
View percentages	โ๏ธ	โ๏ธ	โ๏ธ	โ๏ธ	โ๏ธ	โ๏ธ
Create investment	โ๏ธ	โ๏ธ	โ๏ธ	โ๏ธ	โ๏ธ	โ๏ธ
Update investment	โ๏ธ	โ๏ธ	โ๏ธ	โ๏ธ	โ๏ธ	โ๏ธ
Delete investment	โ๏ธ	โ๏ธ	โ๏ธ	โ๏ธ	โ๏ธ	โ๏ธ
Export detailed	โ๏ธ	โ๏ธ	โ๏ธ	โ๏ธ	โ๏ธ	โ๏ธ
Impersonation	โ๏ธ	โ๏ธ	โ๏ธ	โ๏ธ	โ๏ธ	โ๏ธ
View Audit Log	โ๏ธ	โ๏ธ	โ๏ธ	โ๏ธ	โ๏ธ	โ๏ธ

ูููุฐ ุงูุฌุฏูู ูู DB ูู roles, permissions, role_permissions ูุณูููุฉ ุงูุชุนุฏูู.

โธป

4. ุชุตููู ูุงุฌูุฉ ุฅุฏุงุฑุฉ ุงูุตูุงุญูุงุช (UI / UX requirements)
	1.	ุตูุญุฉ Admin โ User Management ุชุนุฑุถ: ูุงุฆูุฉ ุงููุณุชุฎุฏูููุ ุฏูุฑูู ุงูุญุงููุ ุฒุฑ Edit Roleุ ุฒุฑ Impersonate (Owner only)ุ ุฒุฑ Suspend, Delete.
	2.	ูุงูุฐุฉ Edit Role: ูุงุฆูุฉ ููุณุฏูุฉ ุจุงูุฏูุฑ + checkboxes ูุตูุงุญูุงุช ูุฎุตุตุฉ (Platform Access checkboxes).
	3.	Panel ูุฅูุดุงุก Role ูุฎุตูุต (Custom Role) ูุน ุงุฎุชูุงุฑ Permissions ุนูู ูุณุชูู ุงูุญูู (ูุซูุงู: ุฑุคูุฉ ูุจุงูุบ Sukuk ููุท ุฃู ุฑุคูุฉ ุฌููุน ุงูููุตุงุช ุจูุณุจ ููุท).
	4.	ุฒุฑ View-As: ูุณูุญ ููู Owner ุจูุนุงููุฉ ุงููุงุฌูุฉ ููุง ูุฑุงูุง ุฃู ุฏูุฑ (non-invasive preview).
	5.	ููุญุฉ Approval Requests: ุชุธูุฑ ุทูุจุงุช Export/Request-View ูAllow/Reject ูู Owner ูุน ุณุจุจ ูููุงุญุธุฉ.

โธป

5. ููุฒุงุช ูุชูุฏูุฉ ูุตูุงุญูุงุช ูุฑูุฉ (Smart Additions)
	โข	Platform-Scoped Permissions: ููู ูุณุชุฎุฏู ุชุญุฏุฏ ูู ููุตุงุช ููุตุฑูุญ ูู ุจุงููุตูู ุฅูููุง (ูุซูุงู: Lendo only).
	โข	Field-Level Masking: ูููู ุถุจุท ุฃู Basic Analyst ูุฑู ROI% ููู ูุง ูุฑู SAR amounts.
	โข	Temporary Roles: ุฅููุงููุฉ ุชุนููู ุฏูุฑ ูุคูุช ููุฏุฉ ุฒูููุฉ (ูุซูุงู: DataEntry โ AdvancedAnalyst ููุฏุฉ 3 ุฃูุงู). ุชููุบู ุชููุงุฆููุง ุนูุฏ ุงูุชูุงุก ุงููุฏุฉ.
	โข	Approval Workflows: ุฃู Export ููุตูู ุฃู ุทูุจ ุนุฑุถ ุจูุงูุงุช ุญุณุงุณุฉ ููุฑู ุนุจุฑ Workflow ูุฑุณู ุทูุจูุง ููู Owner ููููุงููุฉ ูุน 2FA.
	โข	Impersonation: Owner ููุฏุฑ ูุฏุฎู ุนูู ุญุณุงุจ ูุณุชุฎุฏู ูุคููุชูุง ููุชุญูู (session limited & fully logged).
	โข	Request View: ุนูุฏ ูุญุงููุฉ ูุณุชุฎุฏู ููุชุญ ุญูู ูุญุฌูุจุ ูุธูุฑ ุฒุฑ Request View ูุฑุณู ุทูุจูุง ููู Owner.

โธป

6. Audit Log & Monitoring
	โข	ุฌุฏูู audit_log ูุญูุธ: { id, actor_id, action_type, target_id, details, ip, user_agent, timestamp }.
	โข	ูุงุฌูุฉ Admin ุชุนุฑุถ ููุชุฑุฉ ุญุณุจ ุงููุณุชุฎุฏู/ุงููุนู/ุงูุชุงุฑูุฎ.
	โข	ุฅุดุนุงุฑุงุช ููุฑูุฉ ููู Owner ุนูุฏ: ุชูุนูู ุฏูุฑ Advanced Analystุ ุทูุจ Export ููุตููุ ุฃู Impersonation.

โธป

7. Endpoints / API (ูุซุงููุฉุ ูููููุฐ ุญุณุจ ุงูู backend stack)
	โข	GET /api/admin/users โ ูุงุฆูุฉ ุงููุณุชุฎุฏููู (Owner/Admin).
	โข	POST /api/admin/users โ ุฅุถุงูุฉ ูุณุชุฎุฏู ุฌุฏูุฏ.
	โข	PUT /api/admin/users/{id}/role โ ุชุบููุฑ ุฏูุฑ.
	โข	POST /api/admin/users/{id}/impersonate โ ุจุฏุฃ ุฌูุณุฉ Impersonation (Owner only).
	โข	POST /api/exports/request โ ุทูุจ Export ููุตู (ูุฑุณู Notification ููู Owner).
	โข	POST /api/permissions/temporary โ ุฅูุดุงุก ุตูุงุญูุฉ ูุคูุชุฉ.
	โข	GET /api/audit โ ุฌูุจ ุงูุณุฌูุงุช (ููุชุฑุฉ).

ูู Endpoint ูุณุฌูู ูุดุงุทู ูู audit_log.

โธป

8. Acceptance Criteria (ูุนุงููุฑ ุงููุจูู)
	1.	Owner ููููู ุฅูุดุงุก/ุชุนุฏูู/ุญุฐู ุฃู ูุณุชุฎุฏู ูุตูุงุญูุฉ ูู ูุงุฌูุฉ Admin.
	2.	Role changes ูุนูุงูุฉ ููุฑูุง ูุชูุนูุณ ุนูู ุฌูุณุงุช ุงููุณุชุฎุฏููู (session refresh ุฃู forced logout ููู tokens ุงููุฏููุฉ).
	3.	Data Entry ูุง ูุฑู ุฃู ุฑูู ููุฏู ูู ุงููุงุฌูุงุช.
	4.	Basic Analyst ูุฑู ูุณุจ ููุท ุฏูู ูุจุงูุบ.
	5.	Advanced Analyst ูุฑู ูู ุงูุชูุงุตูู (ุงูุฃุฑูุงูุ ุงูุชูุงุฑูุฎุ ุงูุชุญุงููู).
	6.	Owner ููููู Impersonate ุฃู ูุณุชุฎุฏู ูุฌูุณุฉ ุชููุต ุชูุณุฌููู ุจุงููุงูู.
	7.	Export ููุตู ูุญุชุงุฌ ููุงููุฉ Owner + 2FA (configurable).
	8.	Temporary Roles ุชุนูู ูุชูููู ุชููุงุฆููุง ูู ุงูููุช ุงููุญุฏููุฏ.
	9.	Audit Log ูุณุฌู ูู ุงูุฃุญุฏุงุซ ุงููุทููุจุฉ ููููู ุชุตุฏูุฑู.

โธป

9. DB Schema ูุฎุชุตุฑ (ููุชุฑุญ)
	โข	users(id, name, email, phone, role_id, is_active, created_at, last_login)
	โข	roles(id, name, description)
	โข	permissions(id, key, description)
	โข	role_permissions(role_id, permission_id)
	โข	user_platforms(user_id, platform_id, access_level) โ ููููุฏ ุงูููุตุงุช
	โข	temporary_roles(id, user_id, role_id, expires_at, created_by)
	โข	audit_log(...) ููุง ุณุจู

โธป

10. UI Examples / Behaviour Notes (ูููุตูู ูุงููุทููุฑ)
	โข	ุนูุฏ Owner โ ูู ุงูุฒุงููุฉ ูุธูุฑ ุฒุฑ โView asโ ููุชุญ ูุงุฆูุฉ ุงูุฃุฏูุงุฑุ ููุนูู Preview (ูุง ูููุญ ุตูุงุญูุงุช ุญููููุฉ).
	โข	ุนูุฏ ูุญุงููุฉ ูุณุชุฎุฏู ูุชุญ ุญูู ูููููู โ ูุธูุฑ modal โRequest viewโ ูุน ุฎุงูุฉ ุงูุณุจุจุ ูุฑุณู Notification ููู Owner.
	โข	Impersonation modal โ ููุถูุญ: โYou will enter user Xโs account as Owner. This session will be logged.โ ุฒุฑ Confirm ูุชุทูุจ 2FA.
	โข	Temporary Role creation: calendar picker + duration + reason. ูุธูุฑ ูู ูุงุฆูุฉ ุงููุณุชุฎุฏููู ุจุงูุญุงูุฉ Active Until DATE.

โธป

11. Testing Scenarios (ูุงุฎุชุจุงุฑ ูุจู ุงูุชุณููู)
	1.	ุฃูุดุฆ ูุณุชุฎุฏู DataEntry ูุฃุฏุฎูู ุตููุง ุฌุฏูุฏูุง โ ุชุฃูุฏ ุฃูู ูุง ูุฑู ุงูุฃุฑูุงู.
	2.	ุบููุฑ ุฏูุฑ ูุณุชุฎุฏู ูู BasicAnalyst โ AdvancedAnalyst ูุคูุชูุง 48 ุณุงุนุฉ โ ุชุฃูุฏ ุจุงููุตูู ููุฃุฑูุงู.
	3.	Owner ูุนูู Impersonate ููุณุชุฎุฏู DataEntry โ ูููุฐ ุฅุฏุฎุงู ุจูุงูุงุช ุจุงุณู ุงููุณุชุฎุฏู ุซู ุฑุงุฌุน Audit Log.
	4.	ุทูุจ Export ููุตู โ ุชุฃูุฏ ุฃู ุงูุทูุจ ูุธู ูุนูููุง ุญุชู ููุงููุฉ Owner.
	5.	ุชุฃูุฏ ูู ุฃู Role change ููุฌุจ session refresh ุฃู ุฅุนุงุฏุฉ ุชุณุฌูู ุฏุฎูู ูููุณุชุฎุฏู ุงููุชุฃุซุฑ.

โธป

12. Deliverables ูุชููุนุฉ ูู ูุฑูู ุงูุชุทููุฑ
	โข	ูุงุฌูุฉ Admin ูุงููุฉ (Add/Edit/Delete users, Change roles, Temporary roles).
	โข	Permissions engine (middleware) ูุทุจู ุนูู ูู API route.
	โข	Audit Log ูุน ูุงุฌูุฉ ุชุตุฏูุฑ.
	โข	Impersonation feature ูุคููุฉ ููุณุฌูุฉ.
	โข	Export Approval Flow.
	โข	Unit & Integration tests ููู permissions.
	โข	ุชูุซูู (Spec.md) ูุดุฑุญ ูู Role ูPermission Matrix ูููู ูุทุจููู.

โธป

ุฅุฐุง ุฑุบุจุชุ ุฃูุชุจ ูู ุงูุขู Prompt ูุฎุชุตุฑ ููุฑููุฒ ูุตูุญ ูุตูู ูู Replit Agent ูุจุงุดุฑุฉ (ุนุฏุฉ ุฃุณุทุฑ ููุฌุฒุฉ) ูุชุจุฏุฃ ุงูุชูููุฐ ุงูููุฑู.
ุฃู ุฃูุฏูู ููู Spec.md ูููุณููู ููุชุญูููู ูุงูุฑูุน ุนูู ุงููุณุชูุฏุน โ ุฃูููุง ุชูุถููุ